<div style="padding-left: 9rem;padding-right: 9rem;">
    <br>
    <div class="row col-md-12 ">
      <h4 style="margin-left: 40%; font-weight: bold;">REPORT ON ISSUES</h4>
    </div>
  <br>
  <div style="margin-left: 1.5rem;margin-right: 1.5rem;background-color: cornsilk;" class="row col-md-12">
    <div class="col-md-6">
      <h3 style="text-align: right"></h3>
      <div class="form-group">
        <label style="margin-top: 2rem;">From Date*</label>
        <ng-datepicker [options]="options" position="top-right" [(ngModel)]="fromdate"></ng-datepicker>
      </div>
    </div>
    <div class="col-md-6">
      <div class="form-group" style="margin-top: 0.8rem">
        <label style="margin-top: 2rem;">To Date*</label>
        <ng-datepicker [options]="options" position="top-right" [(ngModel)]="todate"></ng-datepicker>
      </div>
    </div>

    <div class="row col-md-12">
      <div style="margin-left: 40%;padding-bottom: 1rem">
        <button type="button" class="btn btn-success" (click)=generateIssueReport(fromdate,todate)><b>GENERATE</b></button>
      </div>
    </div>
    <br>
  </div>
<br>

  <div style="text-align:center" *ngIf="viewIssueReport?.length> 0">
    <button type="button" class="btn btn-success" (click)="exportToExcel()"><b>EXPORT TO EXCEL</b></button>
  </div>
  <br>

  <div style="margin-left: 1.5rem;margin-right: 1.5rem; text-align: center; width:100%">
    <table class="table table-responsive table-hover table-bordered table" *ngIf="viewIssueReport"style="display: inline-table;text-align:center;background-color:cornsilk">
      <thead class="tableHead">
        <th> Reference Number </th>
        <th> Issue Type </th>
        <th> Description </th>
        <th> Status </th>
        <th> Project Name </th>
        <th> Issue Raised by </th>
        <th>Fix Start Date</th>
        <th>Fix End Date</th>
      </thead>
      <tbody>
        <tr *ngFor="let x of viewIssueReport">
            <td>{{x.ticketnumber}} </td>
            <td>{{x.issuetype}}</td>
            <td>{{x.description}}</td>
            <td>{{x.statuslabel}}</td>
            <td>{{x.projectname}}</td>
            <td>{{x.assignedname}}</td>
            <td *ngIf="x.status_id !='5'">
              -
            </td>
            <td *ngIf="x.status_id !='5'">
              -
            </td>
            <td *ngIf="x.status_id =='5'">
              {{x.fixstartDT}}
            </td>
            <td *ngIf="x.status_id =='5'">
              {{x.fixendDT}}
            </td>
        </tr>
        <tr *ngIf="viewIssueReport?.length == 0">
          <td colspan="8" class="no-data-available">No records found</td>
        </tr>
      </tbody>
    </table>
  </div>
  <br>


<div id='exportable1' style="visibility: hidden !important;">
  <table *ngIf='viewIssueReport' cellspacing="0" rules="rows" border="1"
   style="color:Black;background-color:White;border-color:#CCCCCC;
   border-width:1px;border-style:None;width:100%;border-collapse:collapse;font-size:11pt;
   text-align:center;">
    <thead class="tableHead">
      <th> Reference Number </th>
      <th> Issue Type </th>
      <th> Description </th>
      <th> Status </th>
      <th> Project Name </th>
      <th> Assigned To </th>
      <th>Fix Start Date</th>
      <th>Fix End Date</th>
    </thead>
    <tbody>
      <tr *ngFor="let x of viewIssueReport">
        <td>{{x.ticketnumber}} </td>
        <td>{{x.issuetype}}</td>
        <td>{{x.description}}</td>
        <td>{{x.statuslabel}}</td>
        <td>{{x.projectname}}</td>
        <td>{{x.assignedname}}</td>
        <td *ngIf="x.status_id !='5'">
          -
        </td>
        <td *ngIf="x.status_id !='5'">
          -
        </td>
        <td *ngIf="x.status_id =='5'">
          {{x.fixstartDT}}
        </td>
        <td *ngIf="x.status_id =='5'">
          {{x.fixendDT}}
        </td>
      </tr>
      <tr *ngIf="viewIssueReport?.length == 0">
        <td colspan="8" class="no-data-available">No records found</td>
      </tr>
    </tbody>
  </table>
</div>
